# Vector Matcher

## Purpose
This module, `vector_matcher.py`, provides functionalities for performing similarity matching between numerical vectors. It is essential for tasks such as finding the most relevant job descriptions for a resume, or vice-versa, by comparing their respective embeddings.

## Dependencies
- `numpy`: Used for efficient numerical operations and array manipulation.
- `sklearn.metrics.pairwise.cosine_similarity`: Specifically used for calculating cosine similarity between vectors.
- `typing`: For type hints.

## Key Components

### `VectorMatcher` Class
Provides methods to compare and find similar vectors.

- **`__init__(self)`**
  - **Purpose**: Initializes the `VectorMatcher` instance.
  - **Workflow**: Currently, it prints an initialization message.

- **`find_most_similar(self, query_vector: List[float], candidate_vectors: List[List[float]]) -> List[Tuple[int, float]]`**
  - **Purpose**: Identifies and ranks candidate vectors based on their cosine similarity to a given query vector.
  - **Parameters**:
    - `query_vector` (List[float]): The embedding vector of the item for which similar items are to be found (e.g., a resume embedding).
    - `candidate_vectors` (List[List[float]]): A list of embedding vectors representing the items to be compared against the query (e.g., job description embeddings).
  - **Returns**:
    - `List[Tuple[int, float]]`: A list of tuples, where each tuple contains the original index of the candidate vector and its cosine similarity score with the `query_vector`. The list is sorted in descending order of similarity scores.
  - **Workflow**:
    1. Converts the input lists to NumPy arrays for efficient calculation.
    2. Computes the cosine similarity between the `query_vector` and all `candidate_vectors`.
    3. Pairs each similarity score with its original index from the `candidate_vectors` list.
    4. Sorts these pairs by similarity score in descending order.
    5. Returns the sorted list.

- **`calculate_similarity(self, vector1: List[float], vector2: List[float]) -> float`**
  - **Purpose**: Calculates the cosine similarity between two individual vectors.
  - **Parameters**:
    - `vector1` (List[float]): The first vector.
    - `vector2` (List[float]): The second vector.
  - **Returns**:
    - `float`: The cosine similarity score between `vector1` and `vector2`.
  - **Workflow**:
    1. Converts the input lists to NumPy arrays.
    2. Computes and returns the cosine similarity.

## Workflow
1. An instance of `VectorMatcher` is created.
2. Embedding vectors (generated by `EmbeddingGenerator` or similar) are provided as input.
3. `find_most_similar` is used to get a ranked list of similar items, or `calculate_similarity` for a pairwise comparison.

## Usage Example
```python
from packages.utilities.vector_matching.vector_matcher import VectorMatcher
import numpy as np

# Initialize the matcher
vector_matcher = VectorMatcher()

# Example vectors (e.g., from an EmbeddingGenerator)
query_vec = [0.1, 0.2, 0.3, 0.4]
candidate_vecs = [
    [0.11, 0.21, 0.31, 0.41],  # Very similar
    [0.9, 0.8, 0.7, 0.6],    # Not similar
    [0.15, 0.25, 0.35, 0.45]   # Moderately similar
]

# Find most similar candidates
similar_results = vector_matcher.find_most_similar(query_vec, candidate_vecs)
print("Most similar candidates (index, similarity):")
for index, score in similar_results:
    print(f"  Index: {index}, Similarity: {score:.4f}")

# Calculate similarity between two specific vectors
sim_score = vector_matcher.calculate_similarity(query_vec, candidate_vecs[0])
print(f"\nSimilarity between query_vec and candidate_vecs[0]: {sim_score:.4f}")
```

## Future Enhancements
- Integration with more advanced vector similarity libraries like FAISS for large-scale vector search.
- Support for different similarity metrics (e.g., Euclidean distance) if required.
- Performance optimizations for very large datasets.